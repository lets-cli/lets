shell: bash

commands:
  run-with-depends:
    description: Test command depends
    depends:
      - greet
      - bar
    cmd: |
      echo "Main"

  override-args:
    description: Test override args
    depends:
      - name: greet
        args: Developer
      - bar
    cmd: echo "Override args"

  override-env:
    description: Test override env
    depends:
      - name: greet
        env:
          LEVEL: DEBUG
    cmd: echo "Override env"

  greet:
    options: |
      Usage: lets greet [<name>]
    env:
      LEVEL: INFO
    cmd: echo Hello ${LETSOPT_NAME:-World} with level ${LEVEL}

  greet-dev:
    ref: greet
    args: Developer

  greet-foo:
    ref: greet
    args: Foo

  bar:
    cmd: echo Bar

  with-ref-in-depends:
    depends:
      - greet
      - name: greet-dev
        env:
          LEVEL: DEBUG
      - name: greet-foo
        args: Bar
    cmd: echo I have ref in depends

  # Test commands for dependency failure tree
  fail-command:
    description: Command that always fails
    cmd: exit 1

  run-with-failing-dep:
    description: Command that depends on a failing command
    depends:
      - fail-command
    cmd: echo "This should not run"

  # More complex dependency chain test
  level2-dep:
    description: Command that depends on a failing command through multiple levels
    depends:
      - run-with-failing-dep
    cmd: echo "This should also not run"

  # Test multiple dependencies with one failing
  multiple-deps-one-fail:
    description: Command with multiple dependencies where one fails
    depends:
      - greet
      - bar 
      - fail-command
    cmd: echo "This should not run"
